<html>
  <style>
    table,
    th,
    td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th,
    td {
      padding: 5px;
    }
  </style>
  <body>
    Search: <input type="text" name="carmodel" id="input">
    <input type="submit" value="Submit" onclick="search()">
    <button id="but1" type="button" onclick="loadXMLDoc()">
      Get all data
    </button>
    <br /><br />
    <table id="demo"></table>
    <p id="msg"></p>
    <br /><br />
  	<img id="carImage"></img>
    <p id="carModel"></p>
    <p id="engineName"></p>
    <p id="cc"></p>
    <p id="ps"></p>
    <p id="nm"></p>
    <p id="trans"></p>
    <p id="maxspeed"></p>
    <p id="numPass"></p>
    <p id="sty"></p>
    <p id="seatMat"></p>
    <p id="seatHook"></p>
    <p id="bonnetCap"></p>
    <p id="sus"></p>

    <script>
      function loadXMLDoc1() {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", "cars.xml", false);
        xmlhttp.send();
        return xmlhttp.responseXML;
      }
      function search(){
        clearDOM();
        xmlDoc = loadXMLDoc1();
        // console.log(xmlDoc)
        x = xmlDoc.getElementsByTagName("Car");
        input = document.getElementById("input").value;
        size = input.length;

        if (input == null || input == ""){
          document.getElementById("demo").innerHTML = "";
          document.getElementById("msg").innerHTML = "Please enter a search term";
          return false;
        }
        let arr = Array.from(x);
        let narr = [];
        for(let i=0;i<arr.length;i++){
          narr.push(arr[i].getElementsByTagName("ModelName")[0].childNodes[0].nodeValue);
        }
        console.log(narr);
        // const result = narr.filter(function(item, index){
        //   console.log(item.toLowerCase().includes(input.toLowerCase()), index);
        // });
        document.getElementById("demo").innerHTML = "";
        document.getElementById("demo").innerHTML += "<tr><th>Model</th><th>Engine</th></tr>";
        const result = narr.filter((e,i)=>{
          if (e.toLowerCase().includes(input.toLowerCase())){
            document.getElementById("msg").innerHTML = "";
            document.getElementById("demo").innerHTML += "<tr><td>" + x[i].getElementsByTagName("ModelName")[0].childNodes[0].nodeValue + "</td><td>" + x[i].getElementsByTagName("Specs")[0].getElementsByTagName("Engine")[0].getElementsByTagName("Name")[0].childNodes[0].nodeValue + "</td></tr>";
          }
        })
      }
      function clearDOM(){
        document.getElementById("carModel").innerHTML = "";
        document.getElementById("engineName").innerHTML = "";
        document.getElementById("cc").innerHTML = "";
        document.getElementById("ps").innerHTML = "";
        document.getElementById("nm").innerHTML = "";
        document.getElementById("trans").innerHTML = "";
        document.getElementById("maxspeed").innerHTML = "";
        document.getElementById("numPass").innerHTML = "";
        document.getElementById("sty").innerHTML = "";
        document.getElementById("seatMat").innerHTML = "";
        document.getElementById("seatHook").innerHTML = "";
        document.getElementById("bonnetCap").innerHTML = "";
        document.getElementById("sus").innerHTML = "";
        document.getElementById("carImage").setAttribute("src", "");
      }
      function loadXMLDoc() {
        clearDOM();
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            readCarInfo(this);
          }
        };
        xmlhttp.open("GET", "cars.xml", true);
        xmlhttp.send();
      }
      function readCarInfo(xml) {
        var i;
        var xmlDoc = xml.responseXML;
        var table = "<tr><th>Segments</th><th>Model</th><th>Year</th></tr>";
        var x = xmlDoc.getElementsByTagName("Car");
        for (i = 0; i < x.length; i++) {
          table +=
            "<tr><td>" +
            x[i].getElementsByTagName("Segments")[0].childNodes[0].nodeValue +
            "</td><td><button onclick=(function(){document.getElementById('demo').innerHTML='';document.getElementById('carImage').setAttribute('src','"+
				x[i].getElementsByTagName("Image")[0].childNodes[0].nodeValue
				+"');document.getElementById('carModel').innerHTML='Model:" +
            x[i].getElementsByTagName("Model")[0].childNodes[0].nodeValue +
            "';document.getElementById('engineName').innerHTML='Engine:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("Name")[0].childNodes[0].nodeValue +
            "';document.getElementById('cc').innerHTML='CC:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("CC")[0].childNodes[0].nodeValue +
            "';document.getElementById('ps').innerHTML='PS:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("PS")[0].childNodes[0].nodeValue +
            "';document.getElementById('nm').innerHTML='NM:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("Nm")[0].childNodes[0].nodeValue +
            "';document.getElementById('trans').innerHTML='Transmission:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("Trans")[0].childNodes[0].nodeValue +
            "';document.getElementById('maxspeed').innerHTML='MaxSpeed:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("Engine")[0]
              .getElementsByTagName("MaxSpeed")[0].childNodes[0].nodeValue +
            "';document.getElementById('numPass').innerHTML='NumberOfPassengers:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("NumberOfPassengers")[0].childNodes[0]
              .nodeValue +
            "';document.getElementById('sty').innerHTML='Style:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("Style")[0].childNodes[0].nodeValue +
            "';document.getElementById('seatMat').innerHTML='SeatMaterial:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("SeatMaterial")[0].childNodes[0].nodeValue +
            "';document.getElementById('seatHook').innerHTML='SeatHook:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("SeatHook")[0].childNodes[0].nodeValue +
            "';document.getElementById('bonnetCap').innerHTML='BonnetCap:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("BonnetCapacity")[0].childNodes[0]
              .nodeValue +
            "';document.getElementById('sus').innerHTML='Suspension:" +
            x[i]
              .getElementsByTagName("Specs")[0]
              .getElementsByTagName("BodyStyle")[0]
              .getElementsByTagName("Sus")[0].childNodes[0].nodeValue +
            "';})()>" +
            x[i].getElementsByTagName("ModelName")[0].childNodes[0].nodeValue +
            "</button></td><td>" +
            x[i].getElementsByTagName("Year")[0].childNodes[0].nodeValue +
            "</td></tr>";
        }
        document.getElementById("demo").innerHTML = table;
      }

      function callCar(counter, doc) {}
    </script>
  </body>
</html>
